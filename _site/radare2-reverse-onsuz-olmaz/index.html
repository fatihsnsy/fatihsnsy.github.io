<!DOCTYPE html> <html lang="tr-TR"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Fatih Åensoy" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Fatih Åensoy" /> <title> Radare2 - Reverse Onsuz Olmaz - Fatih Åensoy </title> <link rel="alternate" href="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" hreflang="tr-TR" /> <link rel="canonical" href="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta name="description" content="Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2&#39;nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Radare2 - Reverse Onsuz Olmaz | " /> <meta property="og:title" content="Radare2 - Reverse Onsuz Olmaz | " /> <meta property="og:type" content="website" /> <meta property="og:url" content="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta property="og:description" content="Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2&#39;nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m." /> <meta property="og:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Radare2 - Reverse Onsuz Olmaz | fatihsnsy" /> <meta name="twitter:url" content="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta name="twitter:site" content="@fatihsnsy" /> <meta name="twitter:creator" content="@fatihsnsy" /> <meta name="twitter:description" content="Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2&#39;nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m." /> <meta name="twitter:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <link type="application/atom+xml" rel="alternate" href="https://fatihsensoy.com/feed.xml" title="Fatih Åensoy" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/fav-32.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Radare2 - Reverse Onsuz Olmaz | Fatih Åensoy</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Radare2 - Reverse Onsuz Olmaz" /> <meta name="author" content="Fatih ÅENSOY" /> <meta property="og:locale" content="tr_TR" /> <meta name="description" content="Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2â€™nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m." /> <meta property="og:description" content="Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2â€™nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m." /> <link rel="canonical" href="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta property="og:url" content="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta property="og:site_name" content="Fatih Åensoy" /> <meta property="og:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-02-04T19:49:00+00:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <meta property="twitter:title" content="Radare2 - Reverse Onsuz Olmaz" /> <script type="application/ld+json"> {"@type":"BlogPosting","image":"https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg","headline":"Radare2 - Reverse Onsuz Olmaz","dateModified":"2020-02-04T19:49:00+00:00","datePublished":"2020-02-04T19:49:00+00:00","url":"https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/","mainEntityOfPage":{"@type":"WebPage","@id":"https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/"},"author":{"@type":"Person","name":"Fatih ÅENSOY"},"description":"Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2â€™nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Anasayfa</a><a class="menu-link" href="/archive/">ArÅŸiv</a><a class="menu-link" href="/about/">HakkÄ±mda</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="main_wrapper"> <div class="toc_wrapper"> <div class="toc_content"> <h2>Ä°Ã§erik</h2> <ul><li><a href="#radare2-nedir">Radare2 Nedir?</a><ul><li><a href="#diÄŸerlerinden-farkÄ±-nedir">DiÄŸerlerinden FarkÄ± Nedir?</a></li></ul></li><li><a href="#rabin2">Rabin2</a></li><li><a href="#baÅŸlayalÄ±m">BaÅŸlayalÄ±m!</a><ul><li><a href="#seek-sÄ±Ã§rama-komutlarÄ±">Seek (SÄ±Ã§rama) KomutlarÄ±</a></li><li><a href="#flagler">Flagler</a></li><li><a href="#analiz-ve-stringler">Analiz Ve Stringler</a></li><li><a href="#fonksiyon-listesi">Fonksiyon Listesi</a></li><li><a href="#registerlar">Registerlar</a></li><li><a href="#gÃ¶rsel-modu-kullanma">GÃ¶rsel Modu Kullanma</a></li><li><a href="#binary-patching">Binary Patching</a></li><li><a href="#binary-search">Binary Search</a></li><li><a href="#radare2-ve-debugging">Radare2 Ve Debugging</a></li><li><a href="#radare2-memory">Radare2 Memory</a></li><li><a href="#neden-bÃ¶yle-bir-ÅŸeye-iÌ‡htiyaÃ§-var">Neden BÃ¶yle Bir Åeye Ä°htiyaÃ§ Var?</a></li></ul></li></ul> </div> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"></article> <header class="header"> <img src="/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" alt="" style="border: 2px solid white; width: 100%;"><br><br> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#radare2-kullanÄ±mÄ±">RADARE2 KULLANIMI</a>, <a class="tag" href="/tags/#radare2-usage">RADARE2 USAGE</a>, <a class="tag" href="/tags/#radare2-technical-post">RADARE2 TECHNICAL POST</a>, <a class="tag" href="/tags/#radare2-reference">RADARE2 REFERENCE</a>, <a class="tag" href="/tags/#radare2-command-examples">RADARE2 COMMAND EXAMPLES</a> </span> </div> <h1 class="header-title" itemprop="headline">Radare2 - Reverse Onsuz Olmaz</h1> <div class="post-meta"> <time datetime="2020-02-04T19:49:00+00:00" itemprop="datePublished"> Feb 04, 2020 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Fatih ÅENSOY</span> </span> <time hidden datetime="" itemprop="dateModified"> Feb 04, 2020 </time> <span hidden itemprop="publisher" itemtype="Person">Fatih ÅENSOY</span> <span hidden itemprop="image">/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg</span> <span hidden itemprop="mainEntityOfPage"><p>Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2â€™nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>Herkese selamlar arkadaÅŸlar. Bu teknik makalemizde sizlere adÄ±nÄ± sÄ±kÃ§a duyduÄŸunuz Radare2â€™nin kÄ±sa ama faydalÄ±, elinizin altÄ±nda bir not niyetinde tutabileceÄŸiniz bir tanÄ±tÄ±mÄ±nÄ± yapacaÄŸÄ±m.</p> <h3 id="radare2-nedir"> <a href="#radare2-nedir" class="anchor-head"></a> Radare2 Nedir? </h3> <p>Radare2 hem disassembler, hem de bir debuggerâ€™dÄ±r. IDA ve Ollydbgâ€™Ä±n birleÅŸiminin 2-3 katÄ± yetenekte bir araÃ§ olarak da tanÄ±mlayabiliriz. Kendinizi bir Reverse Engineer olarak tanÄ±mlÄ±yorsanÄ±z basic seviyede de olsa bilmeniz gerektiÄŸini dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼m bir araÃ§tÄ±r. AlÄ±ÅŸtÄ±ktan sonra sizi Ã§ok iyi bir analist veya Reverse Engineer yapabilecek tÃ¼rden bir araÃ§tÄ±r. Linux ve Windows iÃ§in sÃ¼rÃ¼mleri bulunmaktadÄ±r fakat Windowsâ€™un ilkel terminalinden dolayÄ± pek zevk alamayabilirsiniz. O yÃ¼zden ÅŸahsen ben Linux Ã¼zerinde kullanÄ±yorum.</p> <h4 id="diÄŸerlerinden-farkÄ±-nedir"> <a href="#diÄŸerlerinden-farkÄ±-nedir" class="anchor-head"></a> DiÄŸerlerinden FarkÄ± Nedir? </h4> <ul> <li>Open-source ve Ã¼cretsizdir,</li> <li>Ã‡ok fonksiyonel bir yapÄ±sÄ± olmasÄ±,</li> <li>YardÄ±mcÄ± araÃ§larÄ±nÄ±n kullanÄ±ÅŸlÄ± olmasÄ±,</li> <li>Terminalde Ã§alÄ±ÅŸmasÄ±na raÄŸmen kullanÄ±mÄ± kolaylaÅŸtÄ±ran grafiksel arayÃ¼ze sahip olmasÄ± ÅŸeklinde sÄ±ralayabiliriz.</li> <li>KullanÄ±ÅŸlÄ± Ã¶zellikler tek bir Ã§atÄ±da toplandÄ±!</li> <li>Veri analizi, binaryâ€™i patchleme, verileri karÅŸÄ±laÅŸtÄ±rma, yeniden yerleÅŸtirme (replacing), gÃ¶rselleÅŸtirme ve Ã§ok daha fazlasÄ±nÄ± sunuyor.</li> <li>Bir Ã§ok mimariyi ve dosya formatÄ±nÄ± destekler.</li> <li>Åu ana kadar Radare2 ile isteyip de aÃ§Ä±lamayan, debug edilemeyen herhangi bir dosyaya Ã§ok az rastlanmaktadÄ±r.</li> </ul> <h3 id="rabin2"> <a href="#rabin2" class="anchor-head"></a> Rabin2 </h3> <p>Rabin2, Radare2â€™nin bir yardÄ±mcÄ± aracÄ±dÄ±r. Binaryâ€™den info vermektedir. Binaryâ€™den stringler, derleme zamanÄ±, programÄ±n yazÄ±ldÄ±ÄŸÄ± dil gibi bir Ã§ok faydalÄ± bilgiyi Ã§Ä±karÄ±r ve bizlere daha analize baÅŸlamadan Ã¶nce Ã¶n bilgi verir.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-1.png" alt="Rabin2" /></p> <p>AyrÄ±ca stringleri tek tek, disassemble ettikten sonra aramak yerine Rabin2 sayesinde de ortaya dÃ¶kebiliriz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-2.png" alt="Rabin2" /></p> <p><code class="language-plaintext highlighter-rouge">-z</code> parametresi bize data segmentindeki stringleri dÃ¶kÃ¼yor. EÄŸer tÃ¼m binarydeki stringleri dÃ¶kmek istiyorsak <code class="language-plaintext highlighter-rouge">-zz </code>parametresini kullanmalÄ±yÄ±z.</p> <p>Elf, PE, Mach-O, Java SÄ±nÄ±flarÄ± ve Ã§ok daha fazla dosyayÄ± yorumlayabilmektedir.</p> <h3 id="baÅŸlayalÄ±m"> <a href="#baÅŸlayalÄ±m" class="anchor-head"></a> BaÅŸlayalÄ±m! </h3> <p>Radare2â€™nin bazÄ± kullanÄ±m ÅŸekilleri mevcuttur.<code class="language-plaintext highlighter-rouge">radare2 dosya.exe</code> ve <code class="language-plaintext highlighter-rouge">r2 dosya.exe</code> ÅŸeklinde iki adet kullanÄ±mÄ± vardÄ±r. Komutumuzu verdikten sonra binaryâ€™i analiz etmemiz gerekmekte.</p> <p><code class="language-plaintext highlighter-rouge">aa</code> komutu ile ( analyse all ) tÃ¼m binaryâ€™i analiz edebilir. Daha detaylÄ± analiz etmek iÃ§in aaa komutunu kullanabiliriz. Analiz iÅŸlemi ile birlikte binaryâ€™deki stringleri , fonksiyonlarÄ± ve daha birÃ§ok Ã¶nemli bilgiyi aÃ§Ä±ÄŸa Ã§Ä±karmÄ±ÅŸ oluyoruz. <code class="language-plaintext highlighter-rouge">aaaa</code> ile de en Ã¼st seviyede analiz yapmÄ±ÅŸ oluyoruz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-3.png" alt="Radare2-3" /></p> <p>Radare2 kullanÄ±rken en bÃ¼yÃ¼k yardÄ±mcÄ±mÄ±z tabiki de dahili de dÃ¶kÃ¼manlarÄ± ya da help komutlarÄ± olacaktÄ±r. <code class="language-plaintext highlighter-rouge">?</code> komutu ile tÃ¼m help dÃ¶kÃ¼manlarÄ±na ulaÅŸabilirsiniz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-4.png" alt="Radare2-4" /></p> <h4 id="seek-sÄ±Ã§rama-komutlarÄ±"> <a href="#seek-sÄ±Ã§rama-komutlarÄ±" class="anchor-head"></a> Seek (SÄ±Ã§rama) KomutlarÄ± </h4> <p><code class="language-plaintext highlighter-rouge">seek</code> komutu ile memorydeki belirli bir adrese gidebiliyoruz. Yani bizim sÄ±Ã§rama komutumuz kÄ±sacasÄ±.</p> <p>Ã–rnek olarak; eÄŸer adÄ± deÄŸiÅŸtirilmemiÅŸ ise main fonksiyonuna <code class="language-plaintext highlighter-rouge">s main</code> komutuyla sÄ±Ã§rayabiliriz. Ya da 0x581236 adresine <code class="language-plaintext highlighter-rouge">s 0x581236</code> ÅŸeklinde sÄ±Ã§rama yapabiliriz. Sadece <code class="language-plaintext highlighter-rouge">s</code> komutunu kullanarak da mevcut bulunan adresi ekrana basabiliriz.</p> <p><code class="language-plaintext highlighter-rouge">s- </code> komutu ile bir Ã¶nceki adrese gidebiliriz. s- n komutu ile n adres undo</p> <p>yapabiliyoruz. <code class="language-plaintext highlighter-rouge">s--</code> ve <code class="language-plaintext highlighter-rouge">s++</code> komutunun etkileri de aÅŸaÄŸÄ±dadÄ±r.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-5.png" alt="Radare2-5" /></p> <h4 id="flagler"> <a href="#flagler" class="anchor-head"></a> Flagler </h4> <p>Analizden sonra Radare2, Ã§Ä±ktÄ±larÄ± bazÄ± offsetler ile iliÅŸkilendirir. Bunlar;</p> <ul> <li>Strings</li> <li>Symbols</li> <li>Sections</li> <li>Relocs</li> <li>Imports</li> <li>Functions olarak sÄ±ralandÄ±rÄ±labilir.</li> </ul> <p>Ve bunlara da genel olarak <strong>flag</strong> adÄ± verilir. Flagler analizlerde bize en Ã§ok yardÄ±mcÄ± olacak noktalardan birisidir. Hangi fonksiyonlarÄ±n kullanÄ±ldÄ±ÄŸÄ± ve importlar Ã¶zellikle Malware Analiziâ€™nde Ã§ok iÅŸimize yaramaktadÄ±r.</p> <p>Var olan flaglerin listesini gÃ¶rÃ¼ntÃ¼lemek iÃ§in <code class="language-plaintext highlighter-rouge">fs</code> komutu kullanÄ±lÄ±r.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-6.png" alt="Radare2-6" /></p> <p>Bir flagin iÃ§eriÄŸini gÃ¶rÃ¼ntÃ¼lemek iÃ§in ise <code class="language-plaintext highlighter-rouge">fs &lt;flag adÄ±&gt;; f</code> komutu kullanÄ±lÄ±r.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-7.png" alt="Radare2-7" /></p> <h4 id="analiz-ve-stringler"> <a href="#analiz-ve-stringler" class="anchor-head"></a> Analiz Ve Stringler </h4> <p>Åimdiye kadar stringleri ekrana Rabin2 yardÄ±mcÄ± aracÄ± ile basÄ±yorduk. Ama analiz esnasÄ±nda nasÄ±l ekrana basacaÄŸÄ±z? <code class="language-plaintext highlighter-rouge">iz</code> komutu sadece data segmentteki stringleri ekrana basacaktÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">izz</code> ise binary iÃ§erisindeki tÃ¼m stringleri ekrana basacaktÄ±r. Bu kullanÄ±mlar Rabin2â€™nin <code class="language-plaintext highlighter-rouge">-z</code> ve <code class="language-plaintext highlighter-rouge">-zz</code> parametreleriyle benzerlik gÃ¶stermektedir.</p> <p>Tek farkÄ± birini programÄ± analiz etmeden Ã¶nce, diÄŸerini ise programÄ± analiz ederken kullanÄ±yor olmamÄ±zdÄ±r. Genel olarak bir C programÄ±nda eÄŸer printf veya herhangi bir Ã§Ä±ktÄ± fonksiyonu ile ekrana bir string basÄ±lÄ±yor ise bu, <strong>str.</strong> etiketi ile iliÅŸkilendirilir ve Radare2â€™de bunu bu ÅŸekilde yorumlar. Bize string olduÄŸunu bildirir. Biz sadece str. etiketine sahip tÃ¼m stringleri bastÄ±rmak istiyorsak da <code class="language-plaintext highlighter-rouge">axt @@ str.*</code> komutunu kullanabiliriz. Bu komut bize istediÄŸimizi verecektir.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-8.jpg" alt="Radare2-8" /></p> <p>Bu komutu kullandÄ±k ama buraya girdiÄŸimiz komutÃ§uklar ne iÅŸe yarÄ±yor? <code class="language-plaintext highlighter-rouge">axt</code> komutu <strong>â€˜verilen referanstaki kodu/veriyi bul</strong>â€™ anlamÄ±na gelmektedir. **@@ ** iÅŸaretleri ise PHPâ€™den de bildiÄŸimiz foreach yineleyici fonksiyonu gibidir. Offset listesi Ã¼zerindeki bir komutu tekrar tekrar Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r. str. ise string bayraklarÄ±nÄ± ifade etmektedir. TÃ¼m bu kombinasyon bize sadece kullanÄ±lan stringleri deÄŸil, aynÄ± zamanda kullanÄ±lan isimleri ve referans verilen komutlarÄ± da listeliyor.</p> <h4 id="fonksiyon-listesi"> <a href="#fonksiyon-listesi" class="anchor-head"></a> Fonksiyon Listesi </h4> <p>Analiz ettiÄŸimiz hedef programÄ±mÄ±zda import edilen fonksiyonlarÄ± gÃ¶rÃ¼ntÃ¼lemek iÃ§in ise <code class="language-plaintext highlighter-rouge">afl</code> komutunu kullanacaÄŸÄ±z. <strong>Analyze Functions List</strong> anlamÄ±na gelen bu komut bize kritik bilgiler vermektedir.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-9.png" alt="Radare2-9" /></p> <p>ProgramÄ±n assembly kodlarÄ±nÄ± gÃ¶rmek iÃ§in Disassemble komutunu girmemiz gerekir. EÄŸer bir fonksiyonun iÃ§erisindeysek <code class="language-plaintext highlighter-rouge">pdf</code> <strong>(print disassemble functions)</strong> komutunu girerek fonksiyonu disassemble edebiliriz. EÄŸer iÃ§inde bulunduÄŸumuz adres bir fonksiyon deÄŸil ise <code class="language-plaintext highlighter-rouge">pd</code> <strong>(printf disassemble)</strong> komutunu girerek assembly kodlarÄ±na eriÅŸebiliriz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-10.png" alt="Radare2-10" /></p> <h4 id="registerlar"> <a href="#registerlar" class="anchor-head"></a> Registerlar </h4> <p>Ã–ncelikle hangi registerlarÄ±n olduÄŸunu gÃ¶rmek iÃ§in <code class="language-plaintext highlighter-rouge">dr</code> komutunu kullanÄ±yoruz. RegisterlarÄ±n iÃ§eriÄŸini ekrana basmak istersek de <code class="language-plaintext highlighter-rouge">pxr @ &lt;register adÄ±&gt;</code> veya <code class="language-plaintext highlighter-rouge">pxr @ &lt;register adresi&gt;</code> ÅŸeklinde komutlarÄ±mÄ±zÄ± kullanabiliriz. AyrÄ±ca bazÄ± Ã¶zel kullanÄ±mlar mevcuttur.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-11.png" alt="Radare2-11" /></p> <p><code class="language-plaintext highlighter-rouge">x/16x @ rip</code> komutu ile rip registerÄ±nÄ±n ne kadarlÄ±k bir alanÄ±nÄ±n gÃ¶sterileceÄŸini belirtir ve ekrana basarÄ±z. Daha fazla veri gÃ¶stermek istiyorsak 16x sizeâ€™Ä±nÄ± daha da artÄ±rmalÄ±yÄ±z.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-12.png" alt="Radare2-12" /></p> <p><code class="language-plaintext highlighter-rouge">dr ebx = 0x01</code> komutu ile istediÄŸimiz registerâ€™Ä± istediÄŸimiz deÄŸere set edebiliyoruz.</p> <h4 id="gÃ¶rsel-modu-kullanma"> <a href="#gÃ¶rsel-modu-kullanma" class="anchor-head"></a> GÃ¶rsel Modu Kullanma </h4> <p>FarklÄ± varyasyonlarÄ± bulunmaktadÄ±r (V). Fakat bizim kullanacaÄŸÄ±mÄ±z ve en iÅŸlevli varyasyonu olan vv modunu kullanacaÄŸÄ±z.</p> <p><code class="language-plaintext highlighter-rouge">VV</code> komutunu girererek konsol ekranÄ± Ã¼zerinden gÃ¶rsel arayÃ¼ze ulaÅŸabilirsiniz. GÃ¶rsel modun da kendi iÃ§inde farklÄ± modlarÄ± bulunmaktadÄ±r. <strong>P</strong> tuÅŸuna basarak farklÄ± modlara geÃ§iÅŸ yapabilirsiniz. AyrÄ±ca Mouseâ€™u kullanabilirsiniz. MenÃ¼lere Mouse ile tÄ±klayabilir ve ok tuÅŸlarÄ±, enter ile seÃ§iminizi yapabilirsiniz. GÃ¶rsel modda bir Ã§ok Ã¶zellik bulunmaktadÄ±r.</p> <p><strong>k</strong> ve <strong>j</strong> tuÅŸlarÄ±yla da aÅŸaÄŸÄ± yukarÄ± ÅŸekilde kodlarÄ±n iÃ§inde gezinebilirsiniz. Enter ile de odaklandÄ±ÄŸÄ±nÄ±z sekmeyi tam ekran yapabilirsiniz. AyrÄ±ca <code class="language-plaintext highlighter-rouge">vv</code> komutu ile sekmeli gÃ¶rÃ¼nÃ¼me geÃ§iÅŸ yapabilirsiniz. <code class="language-plaintext highlighter-rouge">:</code> komutu ile gÃ¶rsel modda iken Radare2 komutlarÄ±nÄ± kullanabilirsiniz. Ã–rneÄŸin <code class="language-plaintext highlighter-rouge">: s main</code> ÅŸeklinde kullanÄ±mÄ± mevcuttur.</p> <p><code class="language-plaintext highlighter-rouge">;</code> komutu ile bulunduÄŸunuz satÄ±ra yorum ekleyebilir veya var olan yorumu silebilirsiniz. <code class="language-plaintext highlighter-rouge">;</code> bu komut ile yorum ekleyebilirsiniz. <code class="language-plaintext highlighter-rouge">; -</code> bu komut ile yorumu silebilirsiniz.</p> <p><strong>+</strong> ve <strong>â€“</strong> tuÅŸlarÄ±na basarak zoom in veya zoom out yapabilirsiniz. Bu aynÄ± zamanda IDAâ€™daki graph view Ã¶zelliÄŸini kazandÄ±rmaktadÄ±r.</p> <p><strong>q</strong> tuÅŸu ile de Graph Modeâ€™dan Ã§Ä±kÄ±ÅŸ yapÄ±p konsol moduna geri dÃ¶nebilirsiniz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-13.png" alt="Radare2-13" /></p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-14.png" alt="Radare2-14" /></p> <h4 id="binary-patching"> <a href="#binary-patching" class="anchor-head"></a> Binary Patching </h4> <p>Radare2â€™nin en Ã¶nemli Ã¶zelliklerinden birisi ise koda istediÄŸimiz gibi mÃ¼dahale etme seÃ§eneÄŸimizin olmasÄ±. Yani kodu patch edebiliriz. Malware analizlerinde anti-vm ve baÅŸka Ã¶nlemleri atlatmak iÃ§in bypass yapmamÄ±z gerektiÄŸini hepimiz biliyoruz. Bunun iÃ§in de Radare2â€™nin patch Ã¶zelliÄŸini kullanmak akÄ±llÄ±ca olacaktÄ±r.</p> <p><strong>Hadi BaÅŸlayalÄ±m!</strong></p> <p>Ã–ncelikle Radare2â€™yi yazma modunda ve Ã¶zelliklerinde baÅŸlatmamÄ±z gerekiyor.</p> <p>Bunun iÃ§in <code class="language-plaintext highlighter-rouge">r2 -w dosya.exe</code> komutu kullanÄ±lÄ±r.</p> <p>Her zaman olduÄŸu gibi ilk iÅŸ olarak binaryâ€™i analiz ediyoruz. <code class="language-plaintext highlighter-rouge">aaaa</code> yeterli dÃ¼zeyde analizi tamamlÄ±yoruz. ProgramÄ±mÄ±zÄ± patchlemek iÃ§in <code class="language-plaintext highlighter-rouge">vv</code> komutu sekmeli gÃ¶rÃ¼nÃ¼m moduna alÄ±yoruz.</p> <p>Åimdi ise GÃ¶rsel Moda geÃ§iÅŸ yaptÄ±k ve ok tuÅŸlarÄ±yla gezinebiliyoruz. Aktif olarak bulunduÄŸumuz satÄ±rÄ±n komutunu deÄŸiÅŸtirmek iÃ§in bÃ¼yÃ¼k â€˜<strong>A</strong>â€™ tuÅŸuna basÄ±yoruz. Ve istediÄŸimiz assembly kodunu yazÄ±p Enterâ€™a basÄ±yoruz. ArtÄ±k ilgili satÄ±rda bizim yazdÄ±ÄŸÄ±mÄ±z kod gÃ¶rÃ¼nÃ¼r oldu.</p> <p>Daha sonra ise hiÃ§bir kaydetme iÅŸlemine gerek kalmadan <strong>q</strong> tuÅŸuna basarak Ã§Ä±kÄ±ÅŸ yapÄ±yoruz. Ve otomatik olarak deÄŸiÅŸikliklerimiz kaydediliyor.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-15.png" alt="Radare2-15" /></p> <h4 id="binary-search"> <a href="#binary-search" class="anchor-head"></a> Binary Search </h4> <p>Radare2â€™nin en gÃ¼zel Ã¶zelliklerinden birisi de assembly kodlarÄ± iÃ§erisinde arama yapabilmemizdir. BirÃ§ok ÅŸekilde arama yapma seÃ§eneÄŸimiz mevcuttur. <code class="language-plaintext highlighter-rouge">?</code> Komutunu kullanarak tÃ¼m komutlara ve dolayÄ±sÄ±yla da arama komutlarÄ±na ulaÅŸabilirsiniz.</p> <p><code class="language-plaintext highlighter-rouge">/ fatih</code> komutu kodlarÄ±n iÃ§erisinde â€˜<strong>fatih</strong>â€™ stringini arayacaktÄ±r ve bulduÄŸu sonuÃ§larÄ± bize adresleri ile dÃ¶necektir.</p> <p><code class="language-plaintext highlighter-rouge">/x! 52</code> komutu bize binarydeki hex olarak <strong>52</strong> olan sonuÃ§larÄ± ekrana basacaktÄ±r.</p> <p><code class="language-plaintext highlighter-rouge"> /a jmp eax</code> komutu, kodu disassemble edecek ve sonra da** jmp eax**â€™Ä± bulup adresiyle birlikte</p> <p>ekrana basacaktÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">/x 1234</code> komutu, hex stringlerde <strong>1234</strong>â€™Ã¼ arayacaktÄ±r ve adresini ekrana basacaktÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">/ca</code> komutu, eÄŸer var ise memoryâ€™deki <strong>AES</strong> anahtarlarÄ±nÄ± bulur.</p> <p><code class="language-plaintext highlighter-rouge">/cr</code> komutu, eÄŸer var ise memoryâ€™deki** RSA Private Key**â€™leri bulur.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-16.png" alt="Radare2-16" /></p> <h4 id="radare2-ve-debugging"> <a href="#radare2-ve-debugging" class="anchor-head"></a> Radare2 Ve Debugging </h4> <p>Radare2â€™nin en can alÄ±cÄ± Ã¶zelliklerinden birisine geldik. Kendisi birÃ§ok mimariyi ve dosya tipini destekliyor demiÅŸtik. O yÃ¼zden de PE dosyalarÄ±nda Mach-O dosyalarÄ±na kadar Ã§oÄŸu dosya tipini debug edebiliyoruz.</p> <p>Bu Ã¶zelliÄŸi Malware Analizinde Dinamik Analiz yaparken Ã§ok iÅŸimize yaramaktadÄ±r. Debug iÅŸlemine baÅŸlamadan Ã¶nce Radare2â€™yi debug modunda baÅŸlatmamÄ±z gerekiyor.</p> <p><code class="language-plaintext highlighter-rouge">r2 -d dosya.exe</code> ÅŸeklinde debug modunda programÄ±mÄ±zÄ± baÅŸlatmÄ±ÅŸ olduk.<code class="language-plaintext highlighter-rouge">r2 -d dosya.exe &lt;arg1&gt; &lt;arg2&gt;</code> komutu ile programÄ±mÄ±za argÃ¼man girebiliyoruz. Tabiki programÄ±mÄ±z argÃ¼man alÄ±yor ise :)</p> <p>Debugger komutlarÄ±na<code class="language-plaintext highlighter-rouge"> d?</code> komutu ile ulaÅŸabilirsiniz.</p> <p><code class="language-plaintext highlighter-rouge">db 0x25466d</code> komutu ile belirtilen adrese breakpoint koyabiliriz.</p> <p><code class="language-plaintext highlighter-rouge">db</code> komutu ile var olan breakpointleri gÃ¶rebiliriz.</p> <p><code class="language-plaintext highlighter-rouge">db- 0x25466d</code> komutu ile belirtilen breakpointi silebiliriz.</p> <p><code class="language-plaintext highlighter-rouge">db-*</code> komutu ile var olan tÃ¼m breakpointleri kaldÄ±rabiliriz.</p> <p><code class="language-plaintext highlighter-rouge">dbd 0x25566d</code></p> <p>Var olan breakpointi kaldÄ±rmadan, devre dÄ±ÅŸÄ± bÄ±rakabiliriz</p> <p><code class="language-plaintext highlighter-rouge">dbe 0x25566d</code></p> <p>Devre dÄ±ÅŸÄ± olan breakpointi, etkin hale getirebiliriz.</p> <p><code class="language-plaintext highlighter-rouge">dc</code> programÄ± direk Ã§alÄ±ÅŸtÄ±rÄ±r. <strong>(Continue execution)</strong></p> <p><code class="language-plaintext highlighter-rouge">dcc</code> programÄ± callâ€™a kadar Ã§alÄ±ÅŸtÄ±rÄ±r. <strong>(Continue Until Call)</strong></p> <p><code class="language-plaintext highlighter-rouge">dcr</code> rogramÄ± returnâ€™a kadar Ã§alÄ±ÅŸtÄ±rÄ±r. <strong>(Continue Until Return)</strong></p> <p><code class="language-plaintext highlighter-rouge"> dcu main</code> programÄ± <strong>main</strong>â€™e kadar Ã§alÄ±ÅŸtÄ±rÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">dcu 0x256674d</code> programÄ± belirtilen adrese kadar Ã§alÄ±ÅŸtÄ±rÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">ds</code> fonksiyonlarÄ±n iÃ§ine girerek (girilebiliyorsa) bir defa ilerletir.(Step Into)</p> <p><code class="language-plaintext highlighter-rouge">ds 10</code> programÄ± fonksiyon iÃ§ine girerek 10 instruction daha Ã§alÄ±ÅŸtÄ±rÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">dso</code> fonksiyonlarÄ±n iÃ§ine girmeden bir defa ilerletir.</p> <p><code class="language-plaintext highlighter-rouge">dso 10</code> programÄ± fonksiyon iÃ§ine girmeden 10 instruction daha Ã§alÄ±ÅŸtÄ±rÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">ood</code> programÄ±mÄ±zÄ± debug modunda <strong>restart</strong> eder.</p> <h4 id="radare2-memory"> <a href="#radare2-memory" class="anchor-head"></a> Radare2 Memory </h4> <p>Radare2â€™nin memory kÄ±smÄ±nda da Ã§ok iÅŸlevli ve yararlÄ± fonksiyonlarÄ± bulunuyor.</p> <p><code class="language-plaintext highlighter-rouge">dm</code> bize memory mapâ€™i gÃ¶sterir.</p> <p><code class="language-plaintext highlighter-rouge">dm=</code> Ascii art bars ÅŸeklinde memory mapâ€™i ekrana basar.</p> <p><code class="language-plaintext highlighter-rouge">dm.</code> mevcutta bulunan adresin memory map adÄ±nÄ± ve adresini ekrana basar.</p> <p><code class="language-plaintext highlighter-rouge">dm- 0x25884689</code> belirtilen adresteki memory mapi deallocate eder.</p> <p><code class="language-plaintext highlighter-rouge"> dms</code> memory snapshotlarÄ±nÄ± gÃ¶rÃ¼ntÃ¼ler.</p> <p><code class="language-plaintext highlighter-rouge">dms &lt;address&gt;</code> verilen adresin memory snapshotâ€™Ä±nÄ± alÄ±r.</p> <p><code class="language-plaintext highlighter-rouge">dms-&lt;id&gt;</code> IDâ€™si girilen memory snapshotâ€™Ä± siler.</p> <p><code class="language-plaintext highlighter-rouge">dmsA &lt;id&gt;</code> IDâ€™si girilen memory snapshotâ€™Ä± uygular.</p> <p><strong>Åimdi ise memoryâ€™de bulunan bir mapâ€™in dumpâ€™Ä±nÄ± almaya Ã§alÄ±ÅŸalÄ±mâ€¦</strong></p> <h4 id="neden-bÃ¶yle-bir-ÅŸeye-iÌ‡htiyaÃ§-var"> <a href="#neden-bÃ¶yle-bir-ÅŸeye-iÌ‡htiyaÃ§-var" class="anchor-head"></a> Neden BÃ¶yle Bir Åeye Ä°htiyaÃ§ Var? </h4> <p>Ã–zellikle Malware Analizi yaparken Malwareâ€™larÄ±n bellekte kendi alanlarÄ±ndan farklÄ± bÃ¶lÃ¼mlerde kritik uygulamalar Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±na ÅŸahit olmuÅŸsunuzdur.</p> <p>Ã–nemli bilgiler elde edebilmek adÄ±na Memoryâ€™den o Ã§alÄ±ÅŸan programÄ± dump etmeliyiz ki amacÄ±mÄ±za ulaÅŸalÄ±m. Bunu Radare2â€™de Ã§ok basit bir ÅŸekilde yapabiliyoruz.</p> <p><code class="language-plaintext highlighter-rouge">dms 0x751236548625f251</code> belirtilen adresin Ã¶ncelikle bir snapshotâ€™Ä±nÄ± alÄ±yoruz. Sonra ise <code class="language-plaintext highlighter-rouge">dmst virus.dmp 0x00007fe665484000</code> komutu ile Ã¶ncelikle diske kaydetmek istediÄŸimiz dosya adÄ±nÄ±, sonra da snapshotâ€™Ä±nÄ± aldÄ±ÄŸÄ±mÄ±z memory mapâ€™in adresini veriyoruz. Daha sonra ise programÄ±mÄ±z ile aynÄ± adreste virus.dmp dosyamÄ±zÄ±n oluÅŸtuÄŸunu gÃ¶rÃ¼yoruz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-17.png" alt="Radare2-17" /></p> <p>VEE SON! Sizlere pratik bir ÅŸekilde kullanabileceÄŸiniz hazÄ±r bilgileri sundum. ArtÄ±k gerisi sizdeâ€¦</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/source.gif" alt="Matrix" /></p> <p><strong>Bol analiz ve rivÃ¶rsler :D</strong></p> </div> </article> <div class="comments"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'fatihsensoy'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/HackIstanbul-Anisi/" > <div class="nav-arrow">Previous</div> <span class="post-title">HackIstanbul'19 AnÄ±sÄ±</span> </a> <a class="post-nav-item post-nav-next" href="/Pratik-WireShark-Filtreleri/"> <div class="nav-arrow">Next</div> <span class="post-title">Pratik Wireshark ğŸ¦ˆ Filtreleri</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="mailto:iletisim@fatihsensoy.com">Contact Me ğŸ“§</a> <a class="footer_item" href="/feed.xml">RSS</a> <small class="footer_copyright"> <span class="footer_item">Fatih Åensoy &copy;2021</span> </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155173124-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-155173124-1'); </script> </div> </div> </body> </html>
