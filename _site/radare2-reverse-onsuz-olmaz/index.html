<!DOCTYPE html> <html lang="tr-TR"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Fatih Şensoy" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Fatih Şensoy" /> <title> Radare2 - Reverse Onsuz Olmaz - Fatih Şensoy </title> <link rel="alternate" href="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" hreflang="tr-TR" /> <link rel="canonical" href="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta name="description" content="Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2&#39;nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Radare2 - Reverse Onsuz Olmaz | " /> <meta property="og:title" content="Radare2 - Reverse Onsuz Olmaz | " /> <meta property="og:type" content="website" /> <meta property="og:url" content="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta property="og:description" content="Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2&#39;nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım." /> <meta property="og:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Radare2 - Reverse Onsuz Olmaz | fatihsnsy" /> <meta name="twitter:url" content="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta name="twitter:site" content="@fatihsnsy" /> <meta name="twitter:creator" content="@fatihsnsy" /> <meta name="twitter:description" content="Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2&#39;nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım." /> <meta name="twitter:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <link type="application/atom+xml" rel="alternate" href="https://fatihsensoy.com/feed.xml" title="Fatih Şensoy" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/fav-32.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Radare2 - Reverse Onsuz Olmaz | Fatih Şensoy</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Radare2 - Reverse Onsuz Olmaz" /> <meta name="author" content="Fatih ŞENSOY" /> <meta property="og:locale" content="tr_TR" /> <meta name="description" content="Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2’nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım." /> <meta property="og:description" content="Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2’nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım." /> <link rel="canonical" href="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta property="og:url" content="https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/" /> <meta property="og:site_name" content="Fatih Şensoy" /> <meta property="og:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-02-04T19:49:00+00:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" /> <meta property="twitter:title" content="Radare2 - Reverse Onsuz Olmaz" /> <script type="application/ld+json"> {"@type":"BlogPosting","image":"https://fatihsensoy.com/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg","headline":"Radare2 - Reverse Onsuz Olmaz","dateModified":"2020-02-04T19:49:00+00:00","datePublished":"2020-02-04T19:49:00+00:00","url":"https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/","mainEntityOfPage":{"@type":"WebPage","@id":"https://fatihsensoy.com/radare2-reverse-onsuz-olmaz/"},"author":{"@type":"Person","name":"Fatih ŞENSOY"},"description":"Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2’nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Anasayfa</a><a class="menu-link" href="/archive/">Arşiv</a><a class="menu-link" href="/about/">Hakkımda</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="main_wrapper"> <div class="toc_wrapper"> <div class="toc_content"> <h2>İçerik</h2> <ul><li><a href="#radare2-nedir">Radare2 Nedir?</a><ul><li><a href="#diğerlerinden-farkı-nedir">Diğerlerinden Farkı Nedir?</a></li></ul></li><li><a href="#rabin2">Rabin2</a></li><li><a href="#başlayalım">Başlayalım!</a><ul><li><a href="#seek-sıçrama-komutları">Seek (Sıçrama) Komutları</a></li><li><a href="#flagler">Flagler</a></li><li><a href="#analiz-ve-stringler">Analiz Ve Stringler</a></li><li><a href="#fonksiyon-listesi">Fonksiyon Listesi</a></li><li><a href="#registerlar">Registerlar</a></li><li><a href="#görsel-modu-kullanma">Görsel Modu Kullanma</a></li><li><a href="#binary-patching">Binary Patching</a></li><li><a href="#binary-search">Binary Search</a></li><li><a href="#radare2-ve-debugging">Radare2 Ve Debugging</a></li><li><a href="#radare2-memory">Radare2 Memory</a></li><li><a href="#neden-böyle-bir-şeye-i̇htiyaç-var">Neden Böyle Bir Şeye İhtiyaç Var?</a></li></ul></li></ul> </div> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"></article> <header class="header"> <img src="/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg" alt="" style="border: 2px solid white; width: 100%;"><br><br> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#radare2-kullanımı">RADARE2 KULLANIMI</a>, <a class="tag" href="/tags/#radare2-usage">RADARE2 USAGE</a>, <a class="tag" href="/tags/#radare2-technical-post">RADARE2 TECHNICAL POST</a>, <a class="tag" href="/tags/#radare2-reference">RADARE2 REFERENCE</a>, <a class="tag" href="/tags/#radare2-command-examples">RADARE2 COMMAND EXAMPLES</a> </span> </div> <h1 class="header-title" itemprop="headline">Radare2 - Reverse Onsuz Olmaz</h1> <div class="post-meta"> <time datetime="2020-02-04T19:49:00+00:00" itemprop="datePublished"> Feb 04, 2020 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Fatih ŞENSOY</span> </span> <time hidden datetime="" itemprop="dateModified"> Feb 04, 2020 </time> <span hidden itemprop="publisher" itemtype="Person">Fatih ŞENSOY</span> <span hidden itemprop="image">/assets/img/radare2-reverse-onsuz-olmaz/img/cover.jpg</span> <span hidden itemprop="mainEntityOfPage"><p>Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2’nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>Herkese selamlar arkadaşlar. Bu teknik makalemizde sizlere adını sıkça duyduğunuz Radare2’nin kısa ama faydalı, elinizin altında bir not niyetinde tutabileceğiniz bir tanıtımını yapacağım.</p> <h3 id="radare2-nedir"> <a href="#radare2-nedir" class="anchor-head"></a> Radare2 Nedir? </h3> <p>Radare2 hem disassembler, hem de bir debugger’dır. IDA ve Ollydbg’ın birleşiminin 2-3 katı yetenekte bir araç olarak da tanımlayabiliriz. Kendinizi bir Reverse Engineer olarak tanımlıyorsanız basic seviyede de olsa bilmeniz gerektiğini düşündüğüm bir araçtır. Alıştıktan sonra sizi çok iyi bir analist veya Reverse Engineer yapabilecek türden bir araçtır. Linux ve Windows için sürümleri bulunmaktadır fakat Windows’un ilkel terminalinden dolayı pek zevk alamayabilirsiniz. O yüzden şahsen ben Linux üzerinde kullanıyorum.</p> <h4 id="diğerlerinden-farkı-nedir"> <a href="#diğerlerinden-farkı-nedir" class="anchor-head"></a> Diğerlerinden Farkı Nedir? </h4> <ul> <li>Open-source ve ücretsizdir,</li> <li>Çok fonksiyonel bir yapısı olması,</li> <li>Yardımcı araçlarının kullanışlı olması,</li> <li>Terminalde çalışmasına rağmen kullanımı kolaylaştıran grafiksel arayüze sahip olması şeklinde sıralayabiliriz.</li> <li>Kullanışlı özellikler tek bir çatıda toplandı!</li> <li>Veri analizi, binary’i patchleme, verileri karşılaştırma, yeniden yerleştirme (replacing), görselleştirme ve çok daha fazlasını sunuyor.</li> <li>Bir çok mimariyi ve dosya formatını destekler.</li> <li>Şu ana kadar Radare2 ile isteyip de açılamayan, debug edilemeyen herhangi bir dosyaya çok az rastlanmaktadır.</li> </ul> <h3 id="rabin2"> <a href="#rabin2" class="anchor-head"></a> Rabin2 </h3> <p>Rabin2, Radare2’nin bir yardımcı aracıdır. Binary’den info vermektedir. Binary’den stringler, derleme zamanı, programın yazıldığı dil gibi bir çok faydalı bilgiyi çıkarır ve bizlere daha analize başlamadan önce ön bilgi verir.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-1.png" alt="Rabin2" /></p> <p>Ayrıca stringleri tek tek, disassemble ettikten sonra aramak yerine Rabin2 sayesinde de ortaya dökebiliriz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-2.png" alt="Rabin2" /></p> <p><code class="language-plaintext highlighter-rouge">-z</code> parametresi bize data segmentindeki stringleri döküyor. Eğer tüm binarydeki stringleri dökmek istiyorsak <code class="language-plaintext highlighter-rouge">-zz </code>parametresini kullanmalıyız.</p> <p>Elf, PE, Mach-O, Java Sınıfları ve çok daha fazla dosyayı yorumlayabilmektedir.</p> <h3 id="başlayalım"> <a href="#başlayalım" class="anchor-head"></a> Başlayalım! </h3> <p>Radare2’nin bazı kullanım şekilleri mevcuttur.<code class="language-plaintext highlighter-rouge">radare2 dosya.exe</code> ve <code class="language-plaintext highlighter-rouge">r2 dosya.exe</code> şeklinde iki adet kullanımı vardır. Komutumuzu verdikten sonra binary’i analiz etmemiz gerekmekte.</p> <p><code class="language-plaintext highlighter-rouge">aa</code> komutu ile ( analyse all ) tüm binary’i analiz edebilir. Daha detaylı analiz etmek için aaa komutunu kullanabiliriz. Analiz işlemi ile birlikte binary’deki stringleri , fonksiyonları ve daha birçok önemli bilgiyi açığa çıkarmış oluyoruz. <code class="language-plaintext highlighter-rouge">aaaa</code> ile de en üst seviyede analiz yapmış oluyoruz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-3.png" alt="Radare2-3" /></p> <p>Radare2 kullanırken en büyük yardımcımız tabiki de dahili de dökümanları ya da help komutları olacaktır. <code class="language-plaintext highlighter-rouge">?</code> komutu ile tüm help dökümanlarına ulaşabilirsiniz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-4.png" alt="Radare2-4" /></p> <h4 id="seek-sıçrama-komutları"> <a href="#seek-sıçrama-komutları" class="anchor-head"></a> Seek (Sıçrama) Komutları </h4> <p><code class="language-plaintext highlighter-rouge">seek</code> komutu ile memorydeki belirli bir adrese gidebiliyoruz. Yani bizim sıçrama komutumuz kısacası.</p> <p>Örnek olarak; eğer adı değiştirilmemiş ise main fonksiyonuna <code class="language-plaintext highlighter-rouge">s main</code> komutuyla sıçrayabiliriz. Ya da 0x581236 adresine <code class="language-plaintext highlighter-rouge">s 0x581236</code> şeklinde sıçrama yapabiliriz. Sadece <code class="language-plaintext highlighter-rouge">s</code> komutunu kullanarak da mevcut bulunan adresi ekrana basabiliriz.</p> <p><code class="language-plaintext highlighter-rouge">s- </code> komutu ile bir önceki adrese gidebiliriz. s- n komutu ile n adres undo</p> <p>yapabiliyoruz. <code class="language-plaintext highlighter-rouge">s--</code> ve <code class="language-plaintext highlighter-rouge">s++</code> komutunun etkileri de aşağıdadır.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-5.png" alt="Radare2-5" /></p> <h4 id="flagler"> <a href="#flagler" class="anchor-head"></a> Flagler </h4> <p>Analizden sonra Radare2, çıktıları bazı offsetler ile ilişkilendirir. Bunlar;</p> <ul> <li>Strings</li> <li>Symbols</li> <li>Sections</li> <li>Relocs</li> <li>Imports</li> <li>Functions olarak sıralandırılabilir.</li> </ul> <p>Ve bunlara da genel olarak <strong>flag</strong> adı verilir. Flagler analizlerde bize en çok yardımcı olacak noktalardan birisidir. Hangi fonksiyonların kullanıldığı ve importlar özellikle Malware Analizi’nde çok işimize yaramaktadır.</p> <p>Var olan flaglerin listesini görüntülemek için <code class="language-plaintext highlighter-rouge">fs</code> komutu kullanılır.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-6.png" alt="Radare2-6" /></p> <p>Bir flagin içeriğini görüntülemek için ise <code class="language-plaintext highlighter-rouge">fs &lt;flag adı&gt;; f</code> komutu kullanılır.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-7.png" alt="Radare2-7" /></p> <h4 id="analiz-ve-stringler"> <a href="#analiz-ve-stringler" class="anchor-head"></a> Analiz Ve Stringler </h4> <p>Şimdiye kadar stringleri ekrana Rabin2 yardımcı aracı ile basıyorduk. Ama analiz esnasında nasıl ekrana basacağız? <code class="language-plaintext highlighter-rouge">iz</code> komutu sadece data segmentteki stringleri ekrana basacaktır.</p> <p><code class="language-plaintext highlighter-rouge">izz</code> ise binary içerisindeki tüm stringleri ekrana basacaktır. Bu kullanımlar Rabin2’nin <code class="language-plaintext highlighter-rouge">-z</code> ve <code class="language-plaintext highlighter-rouge">-zz</code> parametreleriyle benzerlik göstermektedir.</p> <p>Tek farkı birini programı analiz etmeden önce, diğerini ise programı analiz ederken kullanıyor olmamızdır. Genel olarak bir C programında eğer printf veya herhangi bir çıktı fonksiyonu ile ekrana bir string basılıyor ise bu, <strong>str.</strong> etiketi ile ilişkilendirilir ve Radare2’de bunu bu şekilde yorumlar. Bize string olduğunu bildirir. Biz sadece str. etiketine sahip tüm stringleri bastırmak istiyorsak da <code class="language-plaintext highlighter-rouge">axt @@ str.*</code> komutunu kullanabiliriz. Bu komut bize istediğimizi verecektir.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-8.jpg" alt="Radare2-8" /></p> <p>Bu komutu kullandık ama buraya girdiğimiz komutçuklar ne işe yarıyor? <code class="language-plaintext highlighter-rouge">axt</code> komutu <strong>‘verilen referanstaki kodu/veriyi bul</strong>’ anlamına gelmektedir. **@@ ** işaretleri ise PHP’den de bildiğimiz foreach yineleyici fonksiyonu gibidir. Offset listesi üzerindeki bir komutu tekrar tekrar çalıştırmak için kullanılır. str. ise string bayraklarını ifade etmektedir. Tüm bu kombinasyon bize sadece kullanılan stringleri değil, aynı zamanda kullanılan isimleri ve referans verilen komutları da listeliyor.</p> <h4 id="fonksiyon-listesi"> <a href="#fonksiyon-listesi" class="anchor-head"></a> Fonksiyon Listesi </h4> <p>Analiz ettiğimiz hedef programımızda import edilen fonksiyonları görüntülemek için ise <code class="language-plaintext highlighter-rouge">afl</code> komutunu kullanacağız. <strong>Analyze Functions List</strong> anlamına gelen bu komut bize kritik bilgiler vermektedir.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-9.png" alt="Radare2-9" /></p> <p>Programın assembly kodlarını görmek için Disassemble komutunu girmemiz gerekir. Eğer bir fonksiyonun içerisindeysek <code class="language-plaintext highlighter-rouge">pdf</code> <strong>(print disassemble functions)</strong> komutunu girerek fonksiyonu disassemble edebiliriz. Eğer içinde bulunduğumuz adres bir fonksiyon değil ise <code class="language-plaintext highlighter-rouge">pd</code> <strong>(printf disassemble)</strong> komutunu girerek assembly kodlarına erişebiliriz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-10.png" alt="Radare2-10" /></p> <h4 id="registerlar"> <a href="#registerlar" class="anchor-head"></a> Registerlar </h4> <p>Öncelikle hangi registerların olduğunu görmek için <code class="language-plaintext highlighter-rouge">dr</code> komutunu kullanıyoruz. Registerların içeriğini ekrana basmak istersek de <code class="language-plaintext highlighter-rouge">pxr @ &lt;register adı&gt;</code> veya <code class="language-plaintext highlighter-rouge">pxr @ &lt;register adresi&gt;</code> şeklinde komutlarımızı kullanabiliriz. Ayrıca bazı özel kullanımlar mevcuttur.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-11.png" alt="Radare2-11" /></p> <p><code class="language-plaintext highlighter-rouge">x/16x @ rip</code> komutu ile rip registerının ne kadarlık bir alanının gösterileceğini belirtir ve ekrana basarız. Daha fazla veri göstermek istiyorsak 16x size’ını daha da artırmalıyız.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-12.png" alt="Radare2-12" /></p> <p><code class="language-plaintext highlighter-rouge">dr ebx = 0x01</code> komutu ile istediğimiz register’ı istediğimiz değere set edebiliyoruz.</p> <h4 id="görsel-modu-kullanma"> <a href="#görsel-modu-kullanma" class="anchor-head"></a> Görsel Modu Kullanma </h4> <p>Farklı varyasyonları bulunmaktadır (V). Fakat bizim kullanacağımız ve en işlevli varyasyonu olan vv modunu kullanacağız.</p> <p><code class="language-plaintext highlighter-rouge">VV</code> komutunu girererek konsol ekranı üzerinden görsel arayüze ulaşabilirsiniz. Görsel modun da kendi içinde farklı modları bulunmaktadır. <strong>P</strong> tuşuna basarak farklı modlara geçiş yapabilirsiniz. Ayrıca Mouse’u kullanabilirsiniz. Menülere Mouse ile tıklayabilir ve ok tuşları, enter ile seçiminizi yapabilirsiniz. Görsel modda bir çok özellik bulunmaktadır.</p> <p><strong>k</strong> ve <strong>j</strong> tuşlarıyla da aşağı yukarı şekilde kodların içinde gezinebilirsiniz. Enter ile de odaklandığınız sekmeyi tam ekran yapabilirsiniz. Ayrıca <code class="language-plaintext highlighter-rouge">vv</code> komutu ile sekmeli görünüme geçiş yapabilirsiniz. <code class="language-plaintext highlighter-rouge">:</code> komutu ile görsel modda iken Radare2 komutlarını kullanabilirsiniz. Örneğin <code class="language-plaintext highlighter-rouge">: s main</code> şeklinde kullanımı mevcuttur.</p> <p><code class="language-plaintext highlighter-rouge">;</code> komutu ile bulunduğunuz satıra yorum ekleyebilir veya var olan yorumu silebilirsiniz. <code class="language-plaintext highlighter-rouge">;</code> bu komut ile yorum ekleyebilirsiniz. <code class="language-plaintext highlighter-rouge">; -</code> bu komut ile yorumu silebilirsiniz.</p> <p><strong>+</strong> ve <strong>–</strong> tuşlarına basarak zoom in veya zoom out yapabilirsiniz. Bu aynı zamanda IDA’daki graph view özelliğini kazandırmaktadır.</p> <p><strong>q</strong> tuşu ile de Graph Mode’dan çıkış yapıp konsol moduna geri dönebilirsiniz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-13.png" alt="Radare2-13" /></p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-14.png" alt="Radare2-14" /></p> <h4 id="binary-patching"> <a href="#binary-patching" class="anchor-head"></a> Binary Patching </h4> <p>Radare2’nin en önemli özelliklerinden birisi ise koda istediğimiz gibi müdahale etme seçeneğimizin olması. Yani kodu patch edebiliriz. Malware analizlerinde anti-vm ve başka önlemleri atlatmak için bypass yapmamız gerektiğini hepimiz biliyoruz. Bunun için de Radare2’nin patch özelliğini kullanmak akıllıca olacaktır.</p> <p><strong>Hadi Başlayalım!</strong></p> <p>Öncelikle Radare2’yi yazma modunda ve özelliklerinde başlatmamız gerekiyor.</p> <p>Bunun için <code class="language-plaintext highlighter-rouge">r2 -w dosya.exe</code> komutu kullanılır.</p> <p>Her zaman olduğu gibi ilk iş olarak binary’i analiz ediyoruz. <code class="language-plaintext highlighter-rouge">aaaa</code> yeterli düzeyde analizi tamamlıyoruz. Programımızı patchlemek için <code class="language-plaintext highlighter-rouge">vv</code> komutu sekmeli görünüm moduna alıyoruz.</p> <p>Şimdi ise Görsel Moda geçiş yaptık ve ok tuşlarıyla gezinebiliyoruz. Aktif olarak bulunduğumuz satırın komutunu değiştirmek için büyük ‘<strong>A</strong>’ tuşuna basıyoruz. Ve istediğimiz assembly kodunu yazıp Enter’a basıyoruz. Artık ilgili satırda bizim yazdığımız kod görünür oldu.</p> <p>Daha sonra ise hiçbir kaydetme işlemine gerek kalmadan <strong>q</strong> tuşuna basarak çıkış yapıyoruz. Ve otomatik olarak değişikliklerimiz kaydediliyor.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-15.png" alt="Radare2-15" /></p> <h4 id="binary-search"> <a href="#binary-search" class="anchor-head"></a> Binary Search </h4> <p>Radare2’nin en güzel özelliklerinden birisi de assembly kodları içerisinde arama yapabilmemizdir. Birçok şekilde arama yapma seçeneğimiz mevcuttur. <code class="language-plaintext highlighter-rouge">?</code> Komutunu kullanarak tüm komutlara ve dolayısıyla da arama komutlarına ulaşabilirsiniz.</p> <p><code class="language-plaintext highlighter-rouge">/ fatih</code> komutu kodların içerisinde ‘<strong>fatih</strong>’ stringini arayacaktır ve bulduğu sonuçları bize adresleri ile dönecektir.</p> <p><code class="language-plaintext highlighter-rouge">/x! 52</code> komutu bize binarydeki hex olarak <strong>52</strong> olan sonuçları ekrana basacaktır.</p> <p><code class="language-plaintext highlighter-rouge"> /a jmp eax</code> komutu, kodu disassemble edecek ve sonra da** jmp eax**’ı bulup adresiyle birlikte</p> <p>ekrana basacaktır.</p> <p><code class="language-plaintext highlighter-rouge">/x 1234</code> komutu, hex stringlerde <strong>1234</strong>’ü arayacaktır ve adresini ekrana basacaktır.</p> <p><code class="language-plaintext highlighter-rouge">/ca</code> komutu, eğer var ise memory’deki <strong>AES</strong> anahtarlarını bulur.</p> <p><code class="language-plaintext highlighter-rouge">/cr</code> komutu, eğer var ise memory’deki** RSA Private Key**’leri bulur.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-16.png" alt="Radare2-16" /></p> <h4 id="radare2-ve-debugging"> <a href="#radare2-ve-debugging" class="anchor-head"></a> Radare2 Ve Debugging </h4> <p>Radare2’nin en can alıcı özelliklerinden birisine geldik. Kendisi birçok mimariyi ve dosya tipini destekliyor demiştik. O yüzden de PE dosyalarında Mach-O dosyalarına kadar çoğu dosya tipini debug edebiliyoruz.</p> <p>Bu özelliği Malware Analizinde Dinamik Analiz yaparken çok işimize yaramaktadır. Debug işlemine başlamadan önce Radare2’yi debug modunda başlatmamız gerekiyor.</p> <p><code class="language-plaintext highlighter-rouge">r2 -d dosya.exe</code> şeklinde debug modunda programımızı başlatmış olduk.<code class="language-plaintext highlighter-rouge">r2 -d dosya.exe &lt;arg1&gt; &lt;arg2&gt;</code> komutu ile programımıza argüman girebiliyoruz. Tabiki programımız argüman alıyor ise :)</p> <p>Debugger komutlarına<code class="language-plaintext highlighter-rouge"> d?</code> komutu ile ulaşabilirsiniz.</p> <p><code class="language-plaintext highlighter-rouge">db 0x25466d</code> komutu ile belirtilen adrese breakpoint koyabiliriz.</p> <p><code class="language-plaintext highlighter-rouge">db</code> komutu ile var olan breakpointleri görebiliriz.</p> <p><code class="language-plaintext highlighter-rouge">db- 0x25466d</code> komutu ile belirtilen breakpointi silebiliriz.</p> <p><code class="language-plaintext highlighter-rouge">db-*</code> komutu ile var olan tüm breakpointleri kaldırabiliriz.</p> <p><code class="language-plaintext highlighter-rouge">dbd 0x25566d</code></p> <p>Var olan breakpointi kaldırmadan, devre dışı bırakabiliriz</p> <p><code class="language-plaintext highlighter-rouge">dbe 0x25566d</code></p> <p>Devre dışı olan breakpointi, etkin hale getirebiliriz.</p> <p><code class="language-plaintext highlighter-rouge">dc</code> programı direk çalıştırır. <strong>(Continue execution)</strong></p> <p><code class="language-plaintext highlighter-rouge">dcc</code> programı call’a kadar çalıştırır. <strong>(Continue Until Call)</strong></p> <p><code class="language-plaintext highlighter-rouge">dcr</code> rogramı return’a kadar çalıştırır. <strong>(Continue Until Return)</strong></p> <p><code class="language-plaintext highlighter-rouge"> dcu main</code> programı <strong>main</strong>’e kadar çalıştırır.</p> <p><code class="language-plaintext highlighter-rouge">dcu 0x256674d</code> programı belirtilen adrese kadar çalıştırır.</p> <p><code class="language-plaintext highlighter-rouge">ds</code> fonksiyonların içine girerek (girilebiliyorsa) bir defa ilerletir.(Step Into)</p> <p><code class="language-plaintext highlighter-rouge">ds 10</code> programı fonksiyon içine girerek 10 instruction daha çalıştırır.</p> <p><code class="language-plaintext highlighter-rouge">dso</code> fonksiyonların içine girmeden bir defa ilerletir.</p> <p><code class="language-plaintext highlighter-rouge">dso 10</code> programı fonksiyon içine girmeden 10 instruction daha çalıştırır.</p> <p><code class="language-plaintext highlighter-rouge">ood</code> programımızı debug modunda <strong>restart</strong> eder.</p> <h4 id="radare2-memory"> <a href="#radare2-memory" class="anchor-head"></a> Radare2 Memory </h4> <p>Radare2’nin memory kısmında da çok işlevli ve yararlı fonksiyonları bulunuyor.</p> <p><code class="language-plaintext highlighter-rouge">dm</code> bize memory map’i gösterir.</p> <p><code class="language-plaintext highlighter-rouge">dm=</code> Ascii art bars şeklinde memory map’i ekrana basar.</p> <p><code class="language-plaintext highlighter-rouge">dm.</code> mevcutta bulunan adresin memory map adını ve adresini ekrana basar.</p> <p><code class="language-plaintext highlighter-rouge">dm- 0x25884689</code> belirtilen adresteki memory mapi deallocate eder.</p> <p><code class="language-plaintext highlighter-rouge"> dms</code> memory snapshotlarını görüntüler.</p> <p><code class="language-plaintext highlighter-rouge">dms &lt;address&gt;</code> verilen adresin memory snapshot’ını alır.</p> <p><code class="language-plaintext highlighter-rouge">dms-&lt;id&gt;</code> ID’si girilen memory snapshot’ı siler.</p> <p><code class="language-plaintext highlighter-rouge">dmsA &lt;id&gt;</code> ID’si girilen memory snapshot’ı uygular.</p> <p><strong>Şimdi ise memory’de bulunan bir map’in dump’ını almaya çalışalım…</strong></p> <h4 id="neden-böyle-bir-şeye-i̇htiyaç-var"> <a href="#neden-böyle-bir-şeye-i̇htiyaç-var" class="anchor-head"></a> Neden Böyle Bir Şeye İhtiyaç Var? </h4> <p>Özellikle Malware Analizi yaparken Malware’ların bellekte kendi alanlarından farklı bölümlerde kritik uygulamalar çalıştırdığına şahit olmuşsunuzdur.</p> <p>Önemli bilgiler elde edebilmek adına Memory’den o çalışan programı dump etmeliyiz ki amacımıza ulaşalım. Bunu Radare2’de çok basit bir şekilde yapabiliyoruz.</p> <p><code class="language-plaintext highlighter-rouge">dms 0x751236548625f251</code> belirtilen adresin öncelikle bir snapshot’ını alıyoruz. Sonra ise <code class="language-plaintext highlighter-rouge">dmst virus.dmp 0x00007fe665484000</code> komutu ile öncelikle diske kaydetmek istediğimiz dosya adını, sonra da snapshot’ını aldığımız memory map’in adresini veriyoruz. Daha sonra ise programımız ile aynı adreste virus.dmp dosyamızın oluştuğunu görüyoruz.</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/radare2-17.png" alt="Radare2-17" /></p> <p>VEE SON! Sizlere pratik bir şekilde kullanabileceğiniz hazır bilgileri sundum. Artık gerisi sizde…</p> <p><img src="/assets/img/radare2-reverse-onsuz-olmaz/img/source.gif" alt="Matrix" /></p> <p><strong>Bol analiz ve rivörsler :D</strong></p> </div> </article> <div class="comments"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'fatihsensoy'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/HackIstanbul-Anisi/" > <div class="nav-arrow">Previous</div> <span class="post-title">HackIstanbul'19 Anısı</span> </a> <a class="post-nav-item post-nav-next" href="/Pratik-WireShark-Filtreleri/"> <div class="nav-arrow">Next</div> <span class="post-title">Pratik Wireshark 🦈 Filtreleri</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="mailto:iletisim@fatihsensoy.com">Contact Me 📧</a> <a class="footer_item" href="/feed.xml">RSS</a> <small class="footer_copyright"> <span class="footer_item">Fatih Şensoy &copy;2021</span> </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155173124-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-155173124-1'); </script> </div> </div> </body> </html>
