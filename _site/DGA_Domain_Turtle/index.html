<!DOCTYPE html> <html lang="tr-TR"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Fatih Şensoy" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Fatih Şensoy" /> <title> DGA - Domain Turtle For Malwares - Fatih Şensoy </title> <link rel="alternate" href="https://fatihsensoy.com/DGA_Domain_Turtle/" hreflang="tr-TR" /> <link rel="canonical" href="https://fatihsensoy.com/DGA_Domain_Turtle/" /> <meta name="description" content="Domain generation algorithm is a most popular techniques last times by used common malwares. I explained this technique from technical persective." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="DGA - Domain Turtle For Malwares | " /> <meta property="og:title" content="DGA - Domain Turtle For Malwares | " /> <meta property="og:type" content="website" /> <meta property="og:url" content="https://fatihsensoy.com/DGA_Domain_Turtle/" /> <meta property="og:description" content="Domain generation algorithm is a most popular techniques last times by used common malwares. I explained this technique from technical persective." /> <meta property="og:image" content="https://fatihsensoy.com/assets/img/dga_domain_turtle/img/cover.jpg" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="DGA - Domain Turtle For Malwares | fatihsnsy" /> <meta name="twitter:url" content="https://fatihsensoy.com/DGA_Domain_Turtle/" /> <meta name="twitter:site" content="@fatihsnsy" /> <meta name="twitter:creator" content="@fatihsnsy" /> <meta name="twitter:description" content="Domain generation algorithm is a most popular techniques last times by used common malwares. I explained this technique from technical persective." /> <meta name="twitter:image" content="https://fatihsensoy.com/assets/img/dga_domain_turtle/img/cover.jpg" /> <link type="application/atom+xml" rel="alternate" href="https://fatihsensoy.com/feed.xml" title="Fatih Şensoy" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/fav-32.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>DGA - Domain Turtle For Malwares | Fatih Şensoy</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="DGA - Domain Turtle For Malwares" /> <meta name="author" content="Fatih ŞENSOY" /> <meta property="og:locale" content="tr_TR" /> <meta name="description" content="Domain generation algorithm is a most popular techniques last times by used common malwares. I explained this technique from technical persective." /> <meta property="og:description" content="Domain generation algorithm is a most popular techniques last times by used common malwares. I explained this technique from technical persective." /> <link rel="canonical" href="https://fatihsensoy.com/DGA_Domain_Turtle/" /> <meta property="og:url" content="https://fatihsensoy.com/DGA_Domain_Turtle/" /> <meta property="og:site_name" content="Fatih Şensoy" /> <meta property="og:image" content="https://fatihsensoy.com/assets/img/dga_domain_turtle/img/cover.jpg" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-02-24T23:55:00+00:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://fatihsensoy.com/assets/img/dga_domain_turtle/img/cover.jpg" /> <meta property="twitter:title" content="DGA - Domain Turtle For Malwares" /> <script type="application/ld+json"> {"@type":"BlogPosting","image":"https://fatihsensoy.com/assets/img/dga_domain_turtle/img/cover.jpg","headline":"DGA - Domain Turtle For Malwares","dateModified":"2021-02-24T23:55:00+00:00","datePublished":"2021-02-24T23:55:00+00:00","url":"https://fatihsensoy.com/DGA_Domain_Turtle/","mainEntityOfPage":{"@type":"WebPage","@id":"https://fatihsensoy.com/DGA_Domain_Turtle/"},"author":{"@type":"Person","name":"Fatih ŞENSOY"},"description":"Domain generation algorithm is a most popular techniques last times by used common malwares. I explained this technique from technical persective.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Anasayfa</a><a class="menu-link" href="/archive/">Arşiv</a><a class="menu-link" href="/about/">Hakkımda</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="main_wrapper"> <div class="toc_wrapper"> <div class="toc_content"> <h2>İçerik</h2> <ul><li><a href="#what-is-the-domain-generation-algorithm-dga">What is the Domain Generation Algorithm (DGA)</a></li><li><a href="#purposes-of-use">Purposes of Use</a></li><li><a href="#what-is-underlying-fundemantal-logic-of-the-dga">What is underlying fundemantal logic of the DGA?</a></li><li><a href="#what-is-the-create-domain-generate-types">What is the create domain generate types?</a><ul><li><a href="#pseudorandom-algorithm">Pseudorandom Algorithm</a><ul><li><a href="#lets-implement-pseudo-random-algorithm">Let’s Implement Pseudo-Random Algorithm</a></li></ul></li><li><a href="#dictionary-based-dg-algorithm">Dictionary Based DG Algorithm</a><ul><li><a href="#lets-implement-dictionary-based-dg-algorithm">Let’s Implement Dictionary Based DG Algorithm</a></li></ul></li></ul></li><li><a href="#references">References</a></li></ul> </div> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"></article> <header class="header"> <img src="/assets/img/dga_domain_turtle/img/cover.jpg" alt="" style="border: 2px solid white; width: 100%;"><br><br> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#domain-generation-algorithm">DOMAIN GENERATION ALGORITHM</a>, <a class="tag" href="/tags/#dga">DGA</a>, <a class="tag" href="/tags/#malware-dga">MALWARE DGA</a>, <a class="tag" href="/tags/#dga-implementation">DGA IMPLEMENTATION</a>, <a class="tag" href="/tags/#what-is-the-dga">WHAT IS THE DGA</a>, <a class="tag" href="/tags/#pseudrandom-generation-algorithm">PSEUDRANDOM GENERATION ALGORITHM</a>, <a class="tag" href="/tags/#pseudorandom-dga">PSEUDORANDOM DGA</a>, <a class="tag" href="/tags/#dictionary-based-dga">DICTIONARY BASED DGA</a> </span> </div> <h1 class="header-title" itemprop="headline">DGA - Domain Turtle For Malwares</h1> <div class="post-meta"> <time datetime="2021-02-24T23:55:00+00:00" itemprop="datePublished"> Feb 24, 2021 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Fatih ŞENSOY</span> </span> <time hidden datetime="" itemprop="dateModified"> Feb 24, 2021 </time> <span hidden itemprop="publisher" itemtype="Person">Fatih ŞENSOY</span> <span hidden itemprop="image">/assets/img/dga_domain_turtle/img/cover.jpg</span> <span hidden itemprop="mainEntityOfPage"><p>Domain generation algorithm is a most popular techniques last times by used common malwares. This technique was used by Conficker, Murofet, BankPatch and more malwares. I will explain you how domain generation algorithm work from technical perspective in this blog post.</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>Domain generation algorithm is a most popular techniques last times by used common malwares. This technique was used by Conficker, Murofet, BankPatch and more malwares. I will explain you how domain generation algorithm work from technical perspective in this blog post.</p> <h2 id="what-is-the-domain-generation-algorithm-dga"> <a href="#what-is-the-domain-generation-algorithm-dga" class="anchor-head"></a> What is the Domain Generation Algorithm (DGA) </h2> <p>Domain generation algorithm is liberation way for the malware authors. Before to DGA, malware required connect to command and control server for receive and send own commands. But there was one problem, command and control server of the malware is a was one. If security researcher or malware protection product catch this domain of the command and control server, would immediately block it. And malicious operation ended for malware and malware author. Because he/she will lost connection to malware and never send any command. This problem is cause point of the DGA emerge.</p> <h2 id="purposes-of-use"> <a href="#purposes-of-use" class="anchor-head"></a> Purposes of Use </h2> <p>Malicious actor, not want provide only communicate between server (C&amp;C) and client (malware). He/She wants to use it another few way in addition.</p> <ul> <li>Confusing the perception of network based protector by genereate many DNS request.</li> <li>Hiding their activities.</li> <li>Increasing malware lifetime through dynamically worked Command Control mechanism.</li> </ul> <h2 id="what-is-underlying-fundemantal-logic-of-the-dga"> <a href="#what-is-underlying-fundemantal-logic-of-the-dga" class="anchor-head"></a> What is underlying fundemantal logic of the DGA? </h2> <p>I describe in the previous section why malware authors needed improve communication skills of the malware. Now, I explain you how it work DGA.</p> <p>DGA is a cryptographic algorithm unified string crafter. Mainly, it’s need to one thing, meeting date. The meeting date means, communication point of the C&amp;C server with malware.</p> <p>Usually meeting date consist of three or six component. The three component is:</p> <ul> <li>Year</li> <li>Month</li> <li>Day</li> </ul> <p>And three of the six components is same with above, but in addition:</p> <ul> <li>Hour</li> <li>Minute</li> <li>Second</li> </ul> <p>The malware author if want per day one connection attempt, will choose the first three component techniques. But security products very strong nowadays, hence resulted domain of this technique, will be very quickly blocked. We can easily see which one is more reliable by looking at the result. Of course, has six components model more reliable, at the same time very harder for security product. The attacker be able to generate <strong>millions of domain</strong> in just a day with six component model like a turtle which transport own house. Therefore; security products, security researchers or security companies can’t block all of them. Now that we’re talking about meeting point models, we can talk about attacker how generate domains and what is the type of domains.</p> <h2 id="what-is-the-create-domain-generate-types"> <a href="#what-is-the-create-domain-generate-types" class="anchor-head"></a> What is the create domain generate types? </h2> <p>Domain generation algorithm have a few types. I will mention pseudorandom algorithm and dictionary based algorithm types. You may will find other few algorithm in the web.</p> <h3 id="pseudorandom-algorithm"> <a href="#pseudorandom-algorithm" class="anchor-head"></a> Pseudorandom Algorithm </h3> <p>The main logic behind the pseudorandom algorithm, generate domains randomly selected by characters in alphabet. Here is a example domain of character based random algorithm: <strong>vkfjsnfkclsmoj[.]com</strong></p> <h4 id="lets-implement-pseudo-random-algorithm"> <a href="#lets-implement-pseudo-random-algorithm" class="anchor-head"></a> Let’s Implement Pseudo-Random Algorithm </h4> <p>Pseudo-random is a cryptographic algorithm which also implement in DGA. Main concept is based on bit shifting and goal of randomness. However, we’re not saying that actually provides truly randomness because algorithm needs to initializer value, and this value generally time of system.</p> <script src="https://gist.github.com/fatihsnsy/5c3b591250c820aef5d2dbba958b584a.js"></script> <p>I customize known pseudorandom algorithm little bit. My goal is to time-sensitive domain generation. When I say time, I am talking about the hour, minute and second. Thus, I added this values to day, month and year values. However, my math is not good for real randomness so, I targeted randomness time based sensitive and I think success it but I don’t allegate ensure to the pseudorandom algorithm conditions. Decision is yours.</p> <p>In my example, I determine the meeting point as <strong>25/02/2021 17:54:23</strong> and set domain length 15 characters. And result is: <strong>syqbyrgonyhdyqn[.]org</strong></p> <h3 id="dictionary-based-dg-algorithm"> <a href="#dictionary-based-dg-algorithm" class="anchor-head"></a> Dictionary Based DG Algorithm </h3> <p>In this case, we have the string array defined earlier. The main purpose of this technique is to make it difficult for AI or ML based security products to detect DGA by creating different domains other than those created with random characters. Domains generated with dictionary based algorithm will appear legal and the security products and security engineer observing network inspect tools will not be suspicious. Because this domains looks like this: catinthefridgefloor[.]xyz or worldcarsrealdonut[.]com.</p> <h4 id="lets-implement-dictionary-based-dg-algorithm"> <a href="#lets-implement-dictionary-based-dg-algorithm" class="anchor-head"></a> Let’s Implement Dictionary Based DG Algorithm </h4> <p>Firstly, should I say this technique mixed with pseudo-random algorithm. We have need randomly created integer number as use dictionary array index. So we supply random index number with pseudo-random algorithm. In other hand, we need to determine how many string combined as domain.</p> <script src="https://gist.github.com/fatihsnsy/8074b79538ca7dbac5479dbdc4934858.js"></script> <p>If we talk about this example, I determine the meeting point as <strong>25/02/2021 11:07:34 **and set domain length is 4 string. Result is: **timeatgameworld[.]io</strong> Dictionary based algorithm have sometimes collisions in this instance. Because our dictionary is very limited. If you would test this algorithm with large dictionary, you’re probably will getting better result then me.</p> <p>Today, we talked about how DGA’s work and what is this types from technical perspective. I’m waiting your thoughts in comment section. I wish you healthy lifes :)</p> <h2 id="references"> <a href="#references" class="anchor-head"></a> References </h2> <p>[1] https://en.wikipedia.org/wiki/Domain_generation_algorithm</p> <p>[2] https://zvelo.com/domain-generation-algorithms-dgas/</p> </div> </article> <div class="comments"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'fatihsensoy'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/peb-traversal-teknigi/" > <div class="nav-arrow">Previous</div> <span class="post-title">PEB Traversal Tekniği</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="mailto:iletisim@fatihsensoy.com">Contact Me 📧</a> <a class="footer_item" href="/feed.xml">RSS</a> <small class="footer_copyright"> <span class="footer_item">Fatih Şensoy &copy;2021</span> </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155173124-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-155173124-1'); </script> </div> </div> </body> </html>
